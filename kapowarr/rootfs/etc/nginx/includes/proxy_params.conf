# ==============================================================================
# proxy_params.conf â€” Common nginx proxy header configuration
#
# Included by servers/ingress.conf via:
#   include /etc/nginx/includes/proxy_params.conf;
#
# These headers pass client information through the proxy to the backend
# application so it can correctly determine the originating IP, protocol,
# and hostname.
# ==============================================================================

# Pass the original Host header (required by many apps for URL construction)
proxy_set_header Host               $http_host;

# Pass the true client IP address
proxy_set_header X-Real-IP          $remote_addr;

# Build the forwarded-for chain
proxy_set_header X-Forwarded-For    $proxy_add_x_forwarded_for;

# Pass the original protocol (http/https)
proxy_set_header X-Forwarded-Proto  $scheme;

# Forward the HA ingress path prefix to the backend.
#
# HA ingress adds an X-Ingress-Path header to every request, containing the
# full path prefix under which the add-on is mounted (e.g. /api/hassio_ingress/<token>).
# Forwarding it allows the backend to be aware of the ingress context.
# Kapowarr's url_base is configured at startup via the database, so this header
# is informational rather than required for path rewriting.
proxy_set_header X-Ingress-Path     $http_x_ingress_path;
